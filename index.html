<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taha Atlagh | Quant Research</title>
    <style>
        /* --- SYSTEM KERNEL STYLES --- */
        :root {
            --bg-color: #050505;
            --glass-bg: rgba(20, 20, 25, 0.85);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #e0e0e0;
            --text-muted: #808080;
            --accent: #3b82f6; /* Research Blue */
            --green: #10b981;
            --red: #ef4444;
            --yellow: #f59e0b;
            --purple: #8b5cf6;
            --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
            --font-serif: 'Times New Roman', serif;
            --font-ui: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-ui);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            user-select: none;
        }

        /* --- BACKGROUND SIMULATION --- */
        canvas#bg-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; opacity: 0.5;
        }

        /* --- DESKTOP --- */
        #desktop {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; opacity: 0; transition: opacity 1s;
        }

        /* ICONS */
        .desktop-icons {
            position: absolute; top: 30px; left: 30px;
            display: flex; flex-direction: column; gap: 25px; z-index: 5;
        }

        .icon {
            width: 80px; display: flex; flex-direction: column; align-items: center;
            cursor: pointer; padding: 10px; border-radius: 6px; transition: 0.2s;
            text-align: center;
        }
        .icon:hover { background: rgba(255, 255, 255, 0.1); transform: translateY(-2px); }
        .icon-img { font-size: 2.2rem; margin-bottom: 8px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5)); }
        .icon-label { font-size: 0.8rem; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.9); font-weight: 500; letter-spacing: 0.5px; }

        /* --- WINDOW MANAGER --- */
        .window {
            position: absolute;
            background: var(--glass-bg);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255,255,255,0.05);
            display: flex; flex-direction: column;
            overflow: hidden;
            transition: transform 0.1s, opacity 0.2s;
            animation: openWindow 0.4s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .window.active { 
            border-color: var(--accent); 
            z-index: 100 !important; 
            box-shadow: 0 40px 80px rgba(0,0,0,0.8), 0 0 0 1px var(--accent); 
        }

        .window-header {
            background: linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(255,255,255,0.01));
            padding: 10px 14px;
            display: flex; align-items: center; justify-content: space-between;
            cursor: grab; border-bottom: 1px solid var(--glass-border);
        }
        .window-header:active { cursor: grabbing; }

        .win-controls { display: flex; gap: 8px; }
        .win-btn { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; transition: 0.2s; position: relative; }
        .win-btn:hover { filter: brightness(1.2); }
        .close-btn { background: #ff5f56; }
        .min-btn { background: #ffbd2e; }
        .max-btn { background: #27c93f; }

        .win-title { font-size: 0.8rem; color: var(--text-muted); font-weight: 500; pointer-events: none; }

        .window-content { flex: 1; overflow-y: auto; color: var(--text-main); position: relative; }

        /* --- PAPER & THESIS STYLES --- */
        .paper-content {
            padding: 40px;
            background: #fff;
            color: #000;
            font-family: var(--font-serif);
            line-height: 1.6;
        }
        .paper-title { font-size: 1.8rem; font-weight: bold; text-align: center; margin-bottom: 5px; color: #000;}
        .paper-meta { text-align: center; font-size: 0.9rem; color: #444; margin-bottom: 30px; font-style: italic; }
        .paper-abstract { font-size: 0.9rem; margin: 0 auto 30px auto; width: 90%; font-style: italic; border-left: 2px solid #ccc; padding-left: 15px; }
        .paper-h1 { font-size: 1.2rem; font-weight: bold; border-bottom: 1px solid #000; padding-bottom: 5px; margin-top: 30px; margin-bottom: 15px; text-transform: uppercase; }
        .paper-h2 { font-size: 1.1rem; font-weight: bold; margin-top: 20px; margin-bottom: 10px; color: #333; }
        .paper-p { margin-bottom: 15px; text-align: justify; font-size: 1rem; }
        .paper-math { 
            background: #f5f5f5; padding: 10px; margin: 15px 0; border-radius: 4px; 
            font-family: var(--font-mono); font-size: 0.9rem; text-align: center; color: #003366;
        }
        .paper-code {
            background: #f4f4f4; border-left: 3px solid #3b82f6;
            font-family: var(--font-mono); font-size: 0.85rem; padding: 10px; margin: 15px 0;
            white-space: pre-wrap; color: #333;
        }
        
        /* Loading Overlay for Compiler */
        .compiler-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: #0d1117; color: var(--green);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-family: var(--font-mono); font-size: 0.9rem;
            z-index: 10;
        }

        /* --- TERMINAL STYLE --- */
        .term-content { padding: 15px; font-family: var(--font-mono); font-size: 0.9rem; }
        .cmd-input { background: transparent; border: none; color: inherit; font: inherit; outline: none; width: 80%; }
        .prompt { color: var(--green); margin-right: 10px; }
        
        /* --- PROFILE STYLE --- */
        .profile-wrap { padding: 30px; text-align: center; }
        .profile-img { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--accent); margin-bottom: 20px; object-fit: cover;}
        .skill-tag { display: inline-block; background: rgba(59, 130, 246, 0.2); color: var(--accent); padding: 4px 10px; border-radius: 100px; font-size: 0.8rem; margin: 3px; border: 1px solid rgba(59, 130, 246, 0.3); }

        /* --- TASKBAR --- */
        #taskbar {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 36px;
            background: rgba(10, 10, 12, 0.95); border-top: 1px solid var(--glass-border);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 15px; font-family: var(--font-mono); font-size: 0.8rem; z-index: 1000;
        }
        #start-btn { 
            background: var(--accent); color: #fff; padding: 4px 12px; border-radius: 4px; 
            font-weight: 700; cursor: pointer; text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        .ticker-wrap { width: 60%; overflow: hidden; white-space: nowrap; mask-image: linear-gradient(90deg, transparent, #000 5%, #000 95%, transparent); }
        .ticker { display: inline-block; animation: ticker 30s linear infinite; }
        .ticker-item { margin-right: 40px; color: var(--text-muted); }
        .ticker-highlight { color: var(--green); font-weight: bold; }
        
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        @keyframes openWindow { from { transform: scale(0.9) translateY(20px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }

    </style>
</head>
<body>

    <div id="boot" style="position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:9999;display:flex;align-items:center;justify-content:center;font-family:monospace;color:#333;">
        <div id="boot-text" style="color:#3fb950">SYSTEM::INIT(QUANT_KERNEL)</div>
    </div>

    <div id="desktop">
        <canvas id="bg-canvas"></canvas>

        <div class="desktop-icons">
            <div class="icon" onclick="openWindow('profile', 150, 100)">
                <div class="icon-img">üë®‚Äçüíª</div>
                <div class="icon-label">Profile</div>
            </div>
            <div class="icon" onclick="openWindow('hull', 200, 150)">
                <div class="icon-img">üìÑ</div>
                <div class="icon-label">Hull_Tactical.tex</div>
            </div>
            <div class="icon" onclick="openWindow('thesis', 250, 200)">
                <div class="icon-img">üéì</div>
                <div class="icon-label">Thesis_RLRK.pdf</div>
            </div>
            <div class="icon" onclick="window.open('./cv_taha_atlagh.pdf')">
                <div class="icon-img">üìù</div>
                <div class="icon-label">Resume.pdf</div>
            </div>
            <div class="icon" onclick="openWindow('terminal', 300, 250)">
                <div class="icon-img">üìü</div>
                <div class="icon-label">Terminal</div>
            </div>
        </div>

        <div id="win-hull" class="window" style="width: 750px; height: 650px; display: none;">
            <div class="window-header" onmousedown="dragStart(event, 'win-hull')">
                <div class="win-controls"><div class="win-btn close-btn" onclick="closeWindow('win-hull')"></div></div>
                <div class="win-title">Hull Tactical: Market Prediction.pdf</div>
                <div></div>
            </div>
            <div class="window-content">
                <div id="hull-compiler" class="compiler-overlay">
                    <div style="margin-bottom: 10px;">Compiling LaTeX Source...</div>
                    <div style="width: 200px; height: 4px; background: #333; border-radius: 2px;">
                        <div id="compiler-bar" style="width: 0%; height: 100%; background: var(--green); transition: width 1.5s;"></div>
                    </div>
                    <div id="compiler-log" style="font-size: 0.7rem; color: #666; margin-top: 10px;">Loading package: amsmath...</div>
                </div>

                <div class="paper-content">
                    <div class="paper-title">Hull Tactical: Market Prediction</div>
                    <div class="paper-title" style="font-size: 1.2rem; font-weight: normal; margin-top:5px;">Strategy Paper: Framework, Models & Theory</div>
                    <div class="paper-meta">Team Strategy Analysis ‚Ä¢ February 2026 ‚Ä¢ Taha Atlagh</div>
                    
                    <div class="paper-abstract">
                        <strong>Abstract:</strong> This document serves as the technical specification for the Hull Tactical Market Prediction competition. We analyze volatility constraints and derive mathematical requirements for maximizing the Sharpe Ratio. We utilize LightGBM ensembles and feedforward neural networks under strict time-series cross-validation.
                    </div>

                    <div class="paper-h1">1. Framework & Constraints</div>
                    <div class="paper-p">
                        The core task is to predict the <strong>Excess Returns</strong> of the S\&P 500. We challenge the Efficient Market Hypothesis (EMH) by identifying statistical inefficiencies ("Alpha") using ML.
                    </div>
                    <div class="paper-math">
                        r_excess = r_SPY - r_risk_free
                    </div>
                    
                    <div class="paper-h1">4. Implementation Strategy</div>
                    <div class="paper-p">
                        Our final submission utilizes an ensemble of <strong>LightGBM</strong> regressors to minimize RMSE on forward returns. The architecture is designed to be robust against regime shifts and volatility spikes.
                    </div>

                    <div class="paper-h2">4.1 Inverse Volatility Weighting</div>
                    <div class="paper-p">
                        To stabilize the learning process in high-volatility environments, sample weights are inversely proportional to the rolling volatility. This prevents the model from overfitting to "noisy" events.
                    </div>
                    <div class="paper-math">
                        w_i = \frac{1}{\sigma_{t-1} + \epsilon}, \quad \text{clipped at 99th percentile}
                    </div>

                    <div class="paper-h2">4.2 Utility-Free Control & Allocation</div>
                    <div class="paper-p">
                        The raw prediction is converted into a portfolio weight using a modified Kelly criterion, constrained by a robust Z-score mechanism to filter weak signals.
                    </div>
                    <div class="paper-code">
def utility_free_control(predicted_mu, current_sigma, history):
    raw_opt = predicted_mu / (current_sigma**2 + 1e-6)
    
    # Robust Z-Score using Median & IQR
    w_median = np.median(history[-252:])
    iqr = np.percentile(history, 75) - np.percentile(history, 25)
    z_score = (raw_opt - w_median) / (iqr * 0.74)
    
    # Crisis Mode: Halve risk if daily vol > 2%
    scaling = 0.5 if current_sigma > 0.02 else 0.8
    
    return 1.0 + np.tanh(z_score * scaling)
                    </div>
                    <div class="paper-p">
                        This approach ensures that we remain fully invested ($w=1$) in neutral markets and only leverage ($w>1$) or deleverage ($w<1$) when the signal-to-noise ratio is statistically significant.
                    </div>
                </div>
            </div>
        </div>

        <div id="win-thesis" class="window" style="width: 800px; height: 600px; display: none;">
            <div class="window-header" onmousedown="dragStart(event, 'win-thesis')">
                <div class="win-controls"><div class="win-btn close-btn" onclick="closeWindow('win-thesis')"></div></div>
                <div class="win-title">Bachelor_Thesis_RLRK.pdf (Summary)</div>
                <div></div>
            </div>
            <div class="window-content paper-content" style="font-family: 'Times New Roman', serif;">
                <div style="text-align: center; border-bottom: 1px solid #ddd; padding-bottom: 20px; margin-bottom: 20px;">
                    <div style="font-size: 1.4rem; font-weight: bold;">Randomized Low-Rank Runge-Kutta Methods</div>
                    <div style="font-style: italic; color: #555; margin-top: 5px;">Bachelor's Thesis @ RWTH Aachen (IGPM)</div>
                    <div style="margin-top: 10px; font-weight: bold;">Grade: 1.0 (Excellent)</div>
                </div>

                <div class="paper-h1">1. Abstract</div>
                <div class="paper-p">
                    This thesis addresses the computational challenges of solving high-dimensional matrix differential equations $\dot{A}(t) = F(A(t))$, where standard integrators fail due to memory constraints ($O(n^2)$). We analyze <strong>Randomized Low-Rank Runge-Kutta (RLRK)</strong> methods, which constrain the solution to a low-rank manifold $\mathcal{M}_r$ using randomized projections (generalized Nystr√∂m approximation).
                </div>

                <div class="paper-h1">2. Methodology: Randomized Sketching</div>
                <div class="paper-p">
                    Instead of a deterministic SVD (which is slow), we employ a randomized sketching approach. The algorithm constructs a subspace approximation by multiplying the data matrix $A$ with a random test matrix $\Omega$.
                </div>
                <div class="paper-math">
                    Y = A\Omega, \quad \text{where } \Omega \text{ is Gaussian or SRFT}
                </div>
                <div class="paper-p">
                    <strong>Key Innovation:</strong> The use of <strong>Subsampled Randomized Fourier Transforms (SRFT)</strong> reduces the complexity of the sketching step from $O(mn^2)$ to $O(mn \log n)$. Our benchmarks confirm that SRFT significantly outperforms dense Gaussian matrices for $n > 8192$.
                </div>

                <div class="paper-h1">3. Error Analysis & Convergence</div>
                <div class="paper-p">
                    We prove that the global error of the RLRK method is bounded by:
                </div>
                <div class="paper-math">
                    \|Y_N - A(T)\|_{L_q} \le C(\delta + \epsilon + h^\gamma)
                </div>
                <div class="paper-p">
                    Unlike Projected Runge-Kutta (PRK) methods, which require the vector field to be tangential to the manifold, RLRK only requires the <em>flow</em> to be approximable. This makes RLRK robust in scenarios where PRK fails (e.g., Lyapunov equation with high perturbations $\alpha=1$).
                </div>

                <div class="paper-h1">4. Numerical Experiments</div>
                <div class="paper-p">
                    <strong>Lyapunov Equation:</strong> RLRK4 maintains 4th-order convergence even when PRK4 collapses due to large projection errors.
                    <br><br>
                    <strong>Allen-Cahn Equation:</strong> For stiff problems, the fixed-step RLRK4 method proved more stable than the adaptive DOPRI45, which suffered from numerical noise in stiff regimes.
                </div>
            </div>
        </div>

        <div id="win-profile" class="window" style="width: 450px; height: 500px; display: none;">
            <div class="window-header" onmousedown="dragStart(event, 'win-profile')">
                <div class="win-controls"><div class="win-btn close-btn" onclick="closeWindow('win-profile')"></div></div>
                <div class="win-title">user_profile.json</div>
                <div></div>
            </div>
            <div class="window-content profile-wrap">
                <img src="./profile.jpg" class="profile-img" onerror="this.src='https://github.com/identicons/taha.png'">
                <h2 style="margin: 0;">Taha Atlagh</h2>
                <p style="color: var(--text-muted); margin-top: 5px;">M.Sc. Mathematics @ TU Berlin</p>
                <div style="margin: 20px 0;">
                    <span class="skill-tag">Stochastic Calculus</span>
                    <span class="skill-tag">Python & C++</span>
                    <span class="skill-tag">High Perf. Computing</span>
                    <span class="skill-tag">Market Microstructure</span>
                </div>
                <p style="text-align: left; font-size: 0.9rem; margin-top: 20px;">
                    Focusing on the intersection of rigorous probability theory and practical algorithmic trading. 
                    Currently building volatility forecasting models for the Hull Tactical Kaggle challenge.
                </p>
                <div style="margin-top: 30px; display: flex; justify-content: center; gap: 10px;">
                    <button onclick="window.open('mailto:atlaghtaha@gmail.com')" style="background: var(--accent); border:none; color:white; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Contact Me</button>
                    <button onclick="window.open('https://github.com/Taha1703')" style="background: #333; border:none; color:white; padding: 8px 16px; border-radius: 4px; cursor: pointer;">GitHub</button>
                </div>
            </div>
        </div>

        <div id="win-terminal" class="window" style="width: 600px; height: 400px; display: none;">
            <div class="window-header" onmousedown="dragStart(event, 'win-terminal')">
                <div class="win-controls"><div class="win-btn close-btn" onclick="closeWindow('win-terminal')"></div></div>
                <div class="win-title">root@taha: ~</div>
                <div></div>
            </div>
            <div class="window-content term-content" onclick="document.getElementById('cmd').focus()">
                <div id="term-out">
                    Welcome to TahaOS v4.2 (Quant Edition)<br>
                    Status: <span style="color:var(--green)">Systems Nominal</span><br><br>
                </div>
                <div style="display: flex;">
                    <span class="prompt">root@taha:~$</span>
                    <input type="text" id="cmd" class="cmd-input" autocomplete="off">
                </div>
            </div>
        </div>

        <div id="taskbar">
            <div style="display:flex; align-items: center;">
                <div id="start-btn">TAHA</div>
                <span style="margin-left: 15px; color: #666;">READY</span>
            </div>
            <div class="ticker-wrap">
                <div class="ticker">
                    <span class="ticker-item">THESIS <span class="ticker-highlight">RLRK METHODS (1.0)</span></span>
                    <span class="ticker-item">STRATEGY <span class="ticker-highlight">SEEKING ALPHA</span></span>
                    <span class="ticker-item">STATUS <span class="ticker-highlight">MODEL CONVERGED</span></span>
                    <span class="ticker-item">KAGGLE <span class="ticker-highlight">HULL TACTICAL: ACTIVE</span></span>
                    <span class="ticker-item">LOCATION <span class="ticker-highlight">BERLIN, DE</span></span>
                </div>
            </div>
            <div id="clock">00:00</div>
        </div>
    </div>

    <script>
        // --- BOOT ---
        window.onload = () => {
            setTimeout(() => {
                document.getElementById('boot').style.display = 'none';
                document.getElementById('desktop').style.opacity = '1';
                initLorenz();
                // Open Hull Tactical Window automatically to show off
                openWindow('hull', 150, 80);
            }, 800);
            setInterval(() => document.getElementById('clock').innerText = new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}), 1000);
        };

        // --- WINDOW MANAGER ---
        let zIndex = 100;
        let activeWin = null;
        let isDragging = false;
        let dragOffset = {x:0, y:0};

        function openWindow(name, x, y) {
            const id = 'win-' + name;
            const el = document.getElementById(id);
            if (!el) return;
            
            el.style.display = 'flex';
            // Set initial position if provided and not already set manually
            if (x && y && el.style.top === "") {
                el.style.left = x + 'px';
                el.style.top = y + 'px';
            }
            moveToFront(id);

            // Special effect for Hull Tactical (Compiler)
            if (name === 'hull') runCompiler();
        }

        function closeWindow(id) {
            document.getElementById(id).style.display = 'none';
        }

        function moveToFront(id) {
            const el = document.getElementById(id);
            el.style.zIndex = ++zIndex;
            document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
            el.classList.add('active');
        }

        function dragStart(e, id) {
            if (e.target.classList.contains('win-btn')) return;
            isDragging = true;
            activeWin = document.getElementById(id);
            moveToFront(id);
            const rect = activeWin.getBoundingClientRect();
            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;
            window.addEventListener('mousemove', dragMove);
            window.addEventListener('mouseup', dragEnd);
        }

        function dragMove(e) {
            if (!isDragging) return;
            activeWin.style.left = (e.clientX - dragOffset.x) + 'px';
            activeWin.style.top = (e.clientY - dragOffset.y) + 'px';
        }

        function dragEnd() {
            isDragging = false;
            window.removeEventListener('mousemove', dragMove);
            window.removeEventListener('mouseup', dragEnd);
        }

        // --- COMPILER SIMULATION ---
        function runCompiler() {
            const bar = document.getElementById('compiler-bar');
            const log = document.getElementById('compiler-log');
            const overlay = document.getElementById('hull-compiler');
            
            // Reset
            overlay.style.display = 'flex';
            bar.style.width = '0%';
            
            const logs = ["Parsing document structure...", "Loading amsmath...", "Generating fonts...", "Processing TikZ graphics...", "Output written: hull_tactical.pdf"];
            
            let step = 0;
            const interval = setInterval(() => {
                if(step >= logs.length) {
                    clearInterval(interval);
                    setTimeout(() => overlay.style.display = 'none', 500);
                } else {
                    log.innerText = logs[step];
                    bar.style.width = ((step + 1) * 20) + '%';
                    step++;
                }
            }, 300);
        }

        // --- TERMINAL ---
        const cmdInput = document.getElementById('cmd');
        const termOut = document.getElementById('term-out');
        
        cmdInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const val = cmdInput.value.toLowerCase().trim();
                termOut.innerHTML += `<div><span class="prompt">root@taha:~$</span> ${val}</div>`;
                
                if(val === 'clear') termOut.innerHTML = '';
                else if(val === 'ls') termOut.innerHTML += `<div style="color:#666">Hull_Tactical.tex  Thesis_RLRK.pdf  cv.pdf  profile.json</div>`;
                else if(val === 'help') termOut.innerHTML += `<div style="color:#3b82f6">Commands: ls, open [file], clear, matrix</div>`;
                else if(val === 'open hull') openWindow('hull', 200, 150);
                else if(val === 'open thesis') openWindow('thesis', 250, 200);
                else if(val === 'matrix') startMatrix();
                else if(val !== '') termOut.innerHTML += `<div style="color:#ef4444">Command not found</div>`;
                
                cmdInput.value = '';
                cmdInput.scrollIntoView();
            }
        });

        // --- LORENZ BACKGROUND ---
        function initLorenz() {
            const canvas = document.getElementById('bg-canvas');
            const ctx = canvas.getContext('2d');
            let w, h;
            const resize = () => { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; };
            window.addEventListener('resize', resize); resize();

            let x=0.1, y=0, z=0;
            const s=10, r=28, b=8/3, dt=0.01;
            const points = [];
            let angle = 0;
            let mode = 'lorenz';

            function draw() {
                if(mode === 'lorenz') {
                    ctx.fillStyle = 'rgba(5, 5, 5, 0.1)'; ctx.fillRect(0,0,w,h);
                    
                    let dx = s*(y-x)*dt;
                    let dy = (x*(r-z)-y)*dt;
                    let dz = (x*y-b*z)*dt;
                    x+=dx; y+=dy; z+=dz;
                    points.push({x,y,z});
                    if(points.length > 2500) points.shift();

                    ctx.beginPath();
                    ctx.strokeStyle = '#3b82f6';
                    ctx.lineWidth = 1;
                    angle += 0.003;

                    const cx=w/2, cy=h/2, scale=18;
                    for(let i=0; i<points.length-1; i++) {
                        let p = points[i], pn = points[i+1];
                        // Rotate Y
                        let rx = p.x*Math.cos(angle) - p.z*Math.sin(angle);
                        let rz = p.x*Math.sin(angle) + p.z*Math.cos(angle);
                        let rxn = pn.x*Math.cos(angle) - pn.z*Math.sin(angle);
                        let rzn = pn.x*Math.sin(angle) + pn.z*Math.cos(angle);
                        // Project
                        let f=400;
                        let s1=f/(f+rz+60), s2=f/(f+rzn+60);
                        ctx.moveTo(cx+rx*scale*s1, cy-p.y*scale*s1);
                        ctx.lineTo(cx+rxn*scale*s2, cy-pn.y*scale*s2);
                    }
                    ctx.stroke();
                }
                requestAnimationFrame(draw);
            }
            draw();
        }
    </script>
</body>
</html>
